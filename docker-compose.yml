name: Taggarr
services:
  taggarr:
    build: .
    image: docker.io/stixzoor/taggarr:latest
    container_name: taggarr
    restart: unless-stopped
    ports:
      - "8080:8080" # API
      - "3000:3000" # Web UI
    environment:
      # Timezone
      - TZ=UTC

      # Logging
      - TAGGARR_LOG_LEVEL=info

      # Frontend API URL (for SSR)
      - VITE_API_URL=http://localhost:8080

      # Sonarr (TV Shows) - set these to enable TV show scanning
      - SONARR_API_KEY=your_sonarr_api_key
      - SONARR_URL=http://sonarr:8989
      - TARGET_GENRE=Anime #OPTIONAL - filter TV shows by genre

      # Radarr (Movies) - set these to enable movie scanning
      - RADARR_API_KEY=your_radarr_api_key
      - RADARR_URL=http://radarr:7878
      - TARGET_GENRE_MOVIES=Anime #OPTIONAL - filter movies by genre

      # Common options
      - TARGET_LANGUAGES=english, french # Supports multiple languages, comma-separated
      - RUN_INTERVAL_SECONDS=7200 #OPTIONAL - default is 2 hours
      - START_RUNNING=true
      - QUICK_MODE=false
      - DRY_RUN=false #OPTIONAL - recommended for first time to avoid writing tags
      - WRITE_MODE=0 #OPTIONAL - 0=NONE, 1=REWRITE, 2=REMOVE
      - TAG_DUB=dub
      - TAG_SEMI=semi-dub
      - TAG_WRONG_DUB=wrong-dub
      - LOG_LEVEL=INFO #OPTIONAL - DEBUG/INFO/WARNING/ERROR
      - ADD_TAG_TO_GENRE=false #OPTIONAL - adds "Dub" genre for fully dubbed content
    volumes:
      # Config and database persistence
      - ./config:/config
      # Media volumes (read-only)
      - /path/to/your/TV:/tv:ro # TV shows - point to "/tv" container path
      - /path/to/your/Movies:/movies:ro # Movies - point to "/movies" container path
      # Logs (optional)
      - /var/log/taggarr:/logs # OPTIONAL - recommended path for logs
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8080/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s
    logging:
      driver: json-file
      options:
        max-size: "10m"
        max-file: "3"
